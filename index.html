<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel 文本处理插件 - 使用教程</title>
    <style>
        :root {
            --primary-color: #007bff;
            --secondary-color: #6c757d;
            --light-gray: #f8f9fa;
            --medium-gray: #e9ecef;
            --dark-gray: #343a40;
            --white: #ffffff;
            --sidebar-width: 240px;
            --header-height: 80px; /* Increased header height */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            line-height: 1.7; /* Slightly increased line height */
            margin: 0;
            padding: 0;
            background-color: var(--light-gray);
            color: var(--dark-gray);
        }

        .main-layout {
            display: flex;
            padding-top: var(--header-height); /* Ensure content isn't hidden behind fixed header */
        }

        header {
            background-color: var(--primary-color);
            color: var(--white);
            padding: 15px 30px; /* Adjusted padding */
            text-align: center;
            position: fixed; /* Fixed header */
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            height: var(--header-height);
            display: flex;
            flex-direction: column; /* Stack title and subtitle */
            justify-content: center; /* Center content vertically */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        header h1 {
            margin: 0 0 5px 0; /* Added bottom margin */
            font-size: 2.2em;
            font-weight: 600; /* Slightly bolder */
        }
        header p {
            margin: 0;
            font-size: 1em;
            opacity: 0.9;
        }

        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--white);
            border-right: 1px solid var(--medium-gray);
            padding: 25px 0px; /* Adjusted padding */
            height: calc(100vh - var(--header-height)); /* Full height minus header */
            position: fixed; /* Fixed sidebar */
            left: 0;
            top: var(--header-height);
            overflow-y: auto; /* Enable scrolling if content overflows */
            box-shadow: 1px 0 3px rgba(0,0,0,0.05);
        }

        .sidebar nav ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .sidebar nav ul li a {
            display: block;
            padding: 12px 25px; /* Adjusted padding */
            text-decoration: none;
            color: var(--dark-gray);
            font-weight: 500;
            transition: background-color 0.3s ease, color 0.3s ease, border-left 0.3s ease;
            border-left: 4px solid transparent; /* Indicator for active link */
        }

        .sidebar nav ul li a:hover {
            background-color: var(--light-gray);
            color: var(--primary-color);
        }

        .sidebar nav ul li a.active {
            color: var(--primary-color);
            background-color: #e6f2ff; /* Light blue background for active */
            border-left-color: var(--primary-color);
            font-weight: 600;
        }

        main.content {
            flex-grow: 1;
            padding: 30px 40px; /* Adjusted padding */
            margin-left: var(--sidebar-width); /* Offset for fixed sidebar */
            background-color: var(--white); /* Give main content a white background */
            min-height: calc(100vh - var(--header-height)); /* Ensure it takes full height */
        }

        section {
            margin-bottom: 40px; /* Increased spacing between sections */
            padding-top: 20px; /* Reduced top padding needed now */
            scroll-margin-top: calc(var(--header-height) + 20px); /* Adjust scroll target position */
        }

        section h2 {
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 8px;
            margin-bottom: 25px;
            color: var(--primary-color);
            font-size: 2em; /* Increased size */
            font-weight: 600;
        }

        section h3 {
            color: #17a2b8; /* Teal color for h3 */
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.6em;
             border-left: 4px solid #17a2b8;
            padding-left: 10px;
        }

        section h4 {
            color: var(--secondary-color);
            margin-top: 25px;
            margin-bottom: 10px;
            font-size: 1.2em;
            font-weight: 600;
        }

        ul, ol {
            padding-left: 25px; /* Adjusted padding */
        }

        li {
            margin-bottom: 12px; /* Increased spacing */
        }

        code {
            background-color: var(--medium-gray);
            padding: 0.25em 0.5em;
            margin: 0;
            font-size: 90%;
            border-radius: 4px;
            font-family: SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
            color: #c7254e; /* Code text color */
            border: 1px solid #e1e1e8;
        }

        pre {
            background-color: var(--medium-gray);
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 90%;
            border: 1px solid #d1d5da;
        }

        pre code {
            background-color: transparent;
            padding: 0;
            margin: 0;
            font-size: inherit;
            border-radius: 0;
            border: none;
            color: var(--dark-gray);
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            border-top: 1px solid var(--medium-gray);
            color: var(--secondary-color);
            font-size: 0.9em;
            background-color: var(--white);
            margin-left: var(--sidebar-width); /* Match main content margin */
        }

        /* Responsive adjustments */
        @media (max-width: 992px) {
            :root {
                --sidebar-width: 200px;
            }
             header h1 { font-size: 2em; }
             section h2 { font-size: 1.8em; }
             section h3 { font-size: 1.5em; }
        }

        @media (max-width: 768px) {
            :root {
                --sidebar-width: 0;
                --header-height: 60px;
            }
             .main-layout {
                 padding-top: var(--header-height);
                 display: block; /* Stack sidebar and content */
             }
             .sidebar {
                 width: 100%;
                 height: auto;
                 position: static; /* No longer fixed */
                 border-right: none;
                 border-bottom: 1px solid var(--medium-gray);
                 padding: 10px 0;
                 box-shadow: none;
                 z-index: 999; /* Below header */
             }
             .sidebar nav ul {
                 display: flex;
                 justify-content: space-around; /* Spread links horizontally */
                 flex-wrap: wrap;
             }
            .sidebar nav ul li a {
                 padding: 8px 15px;
                 border-left: none;
                 border-bottom: 3px solid transparent; /* Use bottom border for active */
                 text-align: center;
             }
             .sidebar nav ul li a.active {
                 border-left: none;
                 border-bottom-color: var(--primary-color);
                 background-color: transparent;
             }
             main.content {
                 margin-left: 0;
                 padding: 20px 15px; /* Reduced padding */
             }
             footer {
                 margin-left: 0;
             }
             header {
                 padding: 10px 20px;
                 height: var(--header-height);
             }
             header h1 { font-size: 1.8em; }
             header p { font-size: 0.9em; }
             section h2 { font-size: 1.6em; }
             section h3 { font-size: 1.4em; }
        }

         @media (max-width: 480px) {
            header h1 { font-size: 1.6em; }
            section h2 { font-size: 1.4em; }
             section h3 { font-size: 1.2em; }
             main.content { padding: 15px 10px; }
             .sidebar nav ul li a { padding: 8px 10px; font-size: 0.9em; }
         }
    </style>
</head>
<body>
    <header>
        <h1>Excel 文本处理插件</h1>
        <p>强大的文本处理工具，提升您的 Excel 操作效率</p>
    </header>

    <div class="main-layout">
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><a href="#intro" class="active">简介</a></li>
                    <li><a href="#features">功能介绍</a></li>
                    <li><a href="#usage">使用说明</a></li>
                    <!-- Add links to specific features within usage if needed -->
                    <!-- Example: <li><a href="#usage-basic">基础文本处理</a></li> -->
                </ul>
            </nav>
        </aside>

        <main class="content">
            <section id="intro">
                <h2>简介</h2>
                <p>这是一个Excel插件，提供了强大的文本处理功能，可以帮助用户轻松地处理Excel单元格中的文本内容。</p>
                <p>本教程旨在帮助您快速熟悉并掌握插件的各项功能，提升数据处理效率。</p>
            </section>

            <section id="features">
                <h2>功能概览</h2>
                <p>插件主要包含以下几大类功能，点击侧边栏的"使用说明"查看具体操作方法：</p>

                <h3>1. 基础文本处理</h3>
                <ul>
                    <li><strong>字符提取</strong>：按类型保留指定字符。</li>
                    <li><strong>字符过滤</strong>：按类型移除指定字符。</li>
                </ul>

                <h3>2. 高级文本处理</h3>
                <ul>
                    <li><strong>正则提取/替换</strong>：使用正则表达式进行复杂匹配操作。</li>
                    <li><strong>文本拆分</strong>：按分隔符拆分到多单元格。</li>
                    <li><strong>格式转换</strong>：大小写、全半角、空格、不可见字符等。</li>
                    <li><strong>姓名处理</strong>：掩码、提取姓/名、加空格。</li>
                    <li><strong>手机号处理</strong>：分段格式化、掩码。</li>
                    <li><strong>中文数字转换</strong>：阿拉伯数字与中文（普通/大写）互转。</li>
                </ul>

                <h3>3. 数值处理</h3>
                <ul>
                    <li><strong>小数处理</strong>：取整、取小数。</li>
                    <li><strong>分数小数互转</strong>：精确转换。</li>
                    <li><strong>引用转换</strong>：相对/绝对引用互转。</li>
                    <li><strong>数值舍入</strong>：多种舍入模式。</li>
                    <li><strong>单位转换</strong>：添加/转换"万"单位。</li>
                    <li><strong>金额转大写</strong>：转为中文大写金额。</li>
                </ul>

                <h3>4. 单元格合并与拆分</h3>
                <ul>
                    <li><strong>文本合并</strong>：多种方式合并内容并物理合并单元格。</li>
                    <li><strong>相同内容合并</strong>：自动合并相邻相同单元格。</li>
                    <li><strong>条件列合并</strong>：按条件列分组合并。</li>
                     <li><strong>整行拆分</strong>：按单列数据拆分整行。</li>
                </ul>

                 <h3>5. 格式处理</h3>
                <ul>
                    <li><strong>保留原值与样式</strong>：修改值和数字格式，保留字体/颜色等。</li>
                </ul>

                <h3>6. 身份证号工具</h3>
                <ul>
                    <li><strong>验证与输入</strong>：实时验证、信息提取、一键输入。</li>
                    <li><strong>掩码处理</strong>：多种模式保护隐私。</li>
                    <li><strong>信息提取</strong>：提取生日、年龄、性别、地址等。</li>
                </ul>
            </section>

            <section id="usage">
                <h2>使用说明</h2>
                <p>以下是各项功能的详细使用步骤：</p>

                <h3 id="usage-basic">基础文本处理 (字符提取/过滤)</h3>
                <ol>
                    <li>在 Excel 中选中您想要处理的一个或多个单元格区域。</li>
                    <li>在插件功能区的"基础文本处理"组中，勾选您希望<strong>提取</strong>（保留）或<strong>过滤</strong>（移除）的字符类型复选框（如：空格、符号、英文、中文、数字）。</li>
                    <li>点击<code>提取字符</code>或<code>过滤字符</code>按钮。</li>
                    <li>根据弹出的提示框，选择一个单元格作为存放处理结果的起始位置。</li>
                    <li>点击"确定"后，处理结果将显示在您选择的目标区域。</li>
                </ol>

                <h3 id="usage-advanced">高级文本处理</h3>
                 <p>大部分高级文本处理功能会直接修改您选中的单元格，操作更便捷。</p>
                <h4>通用步骤</h4>
                 <ol>
                    <li>选择要处理的单元格区域。</li>
                    <li>点击功能区"高级文本处理"或"姓名处理"等分组中对应的按钮。</li>
                    <li>**如果弹出设置窗口**: 根据窗口提示完成设置（如选择模式、输入参数等），然后点击"执行"或"确定"。</li>
                    <li>**如果无设置窗口**: 功能将直接应用到选中单元格。</li>
                    <li>操作完成后通常会弹出消息框，告知处理结果（成功数量、失败数量等）。</li>
                </ol>

                <h4>特定功能说明</h4>
                 <ul>
                     <li><strong>文本合并 (<code>文本合并</code>按钮)</strong>: 选择区域后，在弹出窗口中设置合并方式（全部/逐行/逐列）、分隔符等，结果将覆盖源区域并物理合并单元格。</li>
                     <li><strong>相同内容合并 (<code>合并相同内容</code>按钮)</strong>: 选择区域后，在弹出窗口中选择合并方向（按列/按行），系统会自动合并相邻相同项。</li>
                     <li><strong>条件列合并 (<code>按条件列合并</code>按钮)</strong>: 需要分别选择"条件区域"（单列）和"待合并区域"（可多列），系统会根据条件列的值对后者进行合并。</li>
                 </ul>


                <h3 id="usage-numeric">数值处理</h3>
                <p>数值处理功能通常也直接作用于选中单元格。</p>
                <h4>通用步骤</h4>
                <ol>
                    <li>选择包含数值的单元格区域。</li>
                    <li>点击功能区"数值处理"分组中对应的按钮（如<code>只保留整数</code>、<code>四舍五入</code>等）。</li>
                    <li>**如果弹出设置窗口**: 根据提示进行设置（如舍入位数、转换模式等），然后点击"确定"。</li>
                    <li>**如果无设置窗口**: 功能将直接应用。</li>
                    <li>查看消息框反馈的处理结果。</li>
                </ol>
                <h4>特定功能说明</h4>
                <ul>
                    <li><strong>分数与小数转换 (<code>分数小数转换</code>按钮)</strong>: 弹出窗口，选择转换类型（分数→小数 / 小数→分数）后确定。</li>
                    <li><strong>相对绝对值转换 (<code>相对绝对值转换</code>按钮)</strong>: 弹出窗口，选择转换类型（相对→绝对 / 绝对→相对）后确定。会处理单元格值或公式中的引用。</li>
                </ul>

                <h3 id="usage-format">单元格格式处理 (保留原值)</h3>
                <ol>
                    <li>选择要处理的单元格区域。</li>
                    <li>点击功能区"格式处理"分组中的<code>保留数值</code>、<code>保留文本</code>或<code>数值转文本</code>按钮。</li>
                    <li>插件会修改单元格的值和数字格式（NumberFormat），但会尽力保留原有的其他样式（如字体、颜色、边框等）。</li>
                </ol>

                <h3 id="usage-idcard">身份证号处理工具</h3>
                <ol>
                    <li><strong>输入 (<code>身份证输入</code>按钮)</strong>: 打开输入窗口，输入18位号码。窗口会实时验证并显示生日、年龄、性别。点击<code>输入到单元格</code>可将号码填入当前选中的Excel单元格。</li>
                    <li><strong>掩码 (<code>身份证变星号</code>按钮)</strong>: 选择包含身份证号的区域，点击按钮。在弹出窗口中选择一种掩码模式（如隐藏生日、显示前4位等），点击"确定"。</li>
                    <li><strong>信息提取 (<code>提取性别</code>、<code>提取年龄</code>等按钮)</strong>: 选择包含身份证号的区域，点击相应提取按钮。弹出窗口通常已预选对应提取项，确认后点击"确定"，结果会输出到新列或指定位置。</li>
                </ol>

                <h3 id="usage-split">整行拆分工具</h3>
                 <ol>
                    <li>选择包含拆分依据数字的<strong>单列</strong>数据区域（例如，数量列）。</li>
                    <li>点击功能区"单元格合并与拆分"分组中的<code>整行拆分</code>按钮。</li>
                    <li>在弹出窗口中：
                        <ul>
                            <li>选择<strong>拆分方式</strong>（按数值、按比例、生成递增编号）。如果选"按比例"，需输入比例值。</li>
                            <li>选择<strong>数据处理方式</strong>（保持原值 / 仅原始行保留值）。</li>
                        </ul>
                    </li>
                    <li>点击"执行"。插件会创建一个名为"整行拆分结果"的新工作簿，并将拆分后的数据放入其中。</li>
                </ol>

            </section>

            <!-- Version History Section Removed -->

        </main>
    </div>

    <footer>
        <p>&copy; 2024 Excel 文本处理插件. All Rights Reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const navLinks = document.querySelectorAll('.sidebar nav ul li a');
            const sections = document.querySelectorAll('main.content section');
            const headerHeight = document.querySelector('header').offsetHeight;
            const sidebar = document.querySelector('.sidebar');

            // Smooth scroll
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    const targetElement = document.getElementById(targetId);
                    if (targetElement) {
                        const elementPosition = targetElement.getBoundingClientRect().top;
                        // Adjust offset based on whether sidebar is fixed or static (for responsive)
                        const isSidebarStatic = window.getComputedStyle(sidebar).position === 'static';
                        const extraOffset = isSidebarStatic ? 10 : 20; // More offset for fixed header
                        const offsetPosition = elementPosition + window.pageYOffset - headerHeight - extraOffset;

                        window.scrollTo({
                            top: offsetPosition,
                            behavior: 'smooth'
                        });

                         // For mobile view where sidebar becomes static nav, remove active class briefly
                         if (isSidebarStatic) {
                            navLinks.forEach(l => l.classList.remove('active'));
                            this.classList.add('active');
                         }
                    }
                });
            });

            // Active nav state on scroll
             function setActiveLink() {
                 let currentSectionId = '';
                 const scrollPosition = window.scrollY + headerHeight + 50; // Adjust threshold

                 sections.forEach( section => {
                     const sectionTop = section.offsetTop;
                     if (scrollPosition >= sectionTop) {
                        currentSectionId = section.getAttribute('id');
                     }
                 });

                 // Handle edge case for the top of the page
                 if (window.scrollY < sections[0].offsetTop - headerHeight - 50) {
                     currentSectionId = sections[0].getAttribute('id');
                 }

                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === currentSectionId) {
                        link.classList.add('active');
                    }
                });
            }

            // Initial call and on scroll
            setActiveLink();
            window.addEventListener('scroll', setActiveLink);
        });
    </script>
</body>
</html>
